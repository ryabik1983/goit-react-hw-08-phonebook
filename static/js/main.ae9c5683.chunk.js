(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[1],{106:function(t,e,n){},108:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n.n(r),a=n(44),u=n.n(a),o=n(37),s=n(24),i=n(15),l=n(8),f=n(27),d=n(70),b=n.n(d),p=n(45),j=n(25),h=Object(i.a)(Object(l.f)({serializableCheck:{ignoredActions:[f.a,f.f,f.b,f.c,f.d,f.e]}})),O={key:"auth",storage:b.a,whitelist:["token"]},g=Object(l.a)({reducer:{auth:Object(f.g)(O,j.b),contacts:p.a},devTools:!1,middleware:h}),v=Object(f.h)(g),x=n(71),m=(n(106),n(126)),C=n(125),k=n(4),y=n(5);function w(t){var e=t.children;return Object(s.c)(j.c.getIsLoggedIn)?e:Object(y.jsx)(k.a,{to:"/login"})}function L(t){var e=t.children,n=t.restricted,r=void 0!==n&&n;return Object(s.c)(j.c.getIsLoggedIn)&&r?Object(y.jsx)(k.a,{to:"/"}):e}var I=n(72),R=n.n(I),z=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,154))})),U=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,153))})),_=Object(r.lazy)((function(){return n.e(6).then(n.bind(null,148))})),A=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,149))})),S=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,150))}));function T(){var t=Object(s.b)(),e=Object(s.c)(j.c.getRefreshingStatus);return Object(r.useEffect)((function(){t(j.a.fetchCurrentUser())}),[t]),!e&&Object(y.jsx)("section",{className:R.a["main-container"],children:Object(y.jsxs)(r.Suspense,{fallback:Object(y.jsx)(m.a,{sx:{width:"100%"},children:Object(y.jsx)(C.a,{})}),children:[Object(y.jsx)(z,{}),Object(y.jsxs)(k.d,{children:[Object(y.jsx)(k.b,{path:"/",element:Object(y.jsx)(L,{children:Object(y.jsx)(_,{})})}),Object(y.jsx)(k.b,{path:"/registration",element:Object(y.jsx)(L,{restricted:!0,children:Object(y.jsx)(A,{})})}),Object(y.jsx)(k.b,{path:"/login",element:Object(y.jsx)(L,{restricted:!0,children:Object(y.jsx)(S,{})})}),Object(y.jsx)(k.b,{path:"/contacts",element:Object(y.jsx)(w,{children:Object(y.jsx)(U,{})})})]})]})})}u.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(s.a,{store:g,children:Object(y.jsx)(x.a,{loading:null,persistor:v,children:Object(y.jsx)(o.a,{children:Object(y.jsx)(T,{})})})})}),document.getElementById("root"))},25:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return O})),n.d(e,"b",(function(){return v}));var r=n(18),c=n(7),a=n.n(c),u=n(19),o=n.n(u),s=n(8);o.a.defaults.baseURL="https://connections-api.herokuapp.com";var i,l=function(t){o.a.defaults.headers.common.Authorization="Bearer ".concat(t)},f=function(){o.a.defaults.headers.common.Authorization=""},d=Object(s.c)("auth/registration",function(){var t=Object(r.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/signup",e);case 3:return n=t.sent,r=n.data,l(r.token),t.abrupt("return",r);case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.response.statusText);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),b=Object(s.c)("auth/login",function(){var t=Object(r.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/login",e);case 3:return n=t.sent,r=n.data,l(r.token),t.abrupt("return",r);case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.response.statusText);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),p=Object(s.c)("auth/logout",Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.post("/users/logout");case 3:f(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0.response.statusText);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))),j=Object(s.c)("auth/refresh",function(){var t=Object(r.a)(a.a.mark((function t(e,n){var r,c,u,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.getState(),null!==(c=r.auth.token)){t.next=4;break}return t.abrupt("return",n.rejectWithValue());case 4:return l(c),t.prev=5,t.next=8,o.a.get("/users/current");case 8:return u=t.sent,s=u.data,t.abrupt("return",s);case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0.response.statusText);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n){return t.apply(this,arguments)}}()),h={registration:d,logOut:p,logIn:b,fetchCurrentUser:j},O={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUsername:function(t){return t.auth.user.name},getRefreshingStatus:function(t){return t.auth.refreshing},getErrorLog:function(t){return t.auth.errorLog},getErrorReg:function(t){return t.auth.errorReg}},g=n(3),v=Object(s.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,refreshing:!1,errorLog:!1,errorReg:!1},extraReducers:(i={},Object(g.a)(i,h.registration.fulfilled,(function(t,e){e.payload?(t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0,t.errorReg=!1):t.errorReg=!0})),Object(g.a)(i,h.logIn.fulfilled,(function(t,e){e.payload?(t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0,t.errorLog=!1):t.errorLog=!0})),Object(g.a)(i,h.logOut.fulfilled,(function(t,e){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(g.a)(i,h.fetchCurrentUser.pending,(function(t){t.refreshing=!0})),Object(g.a)(i,h.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.refreshing=!1,t.isLoggedIn=!0})),Object(g.a)(i,h.fetchCurrentUser.rejected,(function(t){t.refreshing=!1})),i)}).reducer},45:function(t,e,n){"use strict";var r,c,a,u=n(3),o=n(15),s=n(8),i=n(12),l=n(58),f=n(9),d=Object(s.d)([],(r={},Object(u.a)(r,f.fetchContacts.fulfilled,(function(t,e){return e.payload})),Object(u.a)(r,f.addContact.fulfilled,(function(t,e){var n=e.payload;return[].concat(Object(o.a)(t),[n])})),Object(u.a)(r,f.deleteContact.fulfilled,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),r)),b=Object(s.d)(!1,(c={},Object(u.a)(c,f.fetchContacts.pending,(function(){return!0})),Object(u.a)(c,f.fetchContacts.fulfilled,(function(){return!1})),Object(u.a)(c,f.fetchContacts.rejected,(function(){return!1})),Object(u.a)(c,f.addContact.pending,(function(){return!0})),Object(u.a)(c,f.addContact.fulfilled,(function(){return!1})),Object(u.a)(c,f.addContact.rejected,(function(){return!1})),Object(u.a)(c,f.deleteContact.pending,(function(){return!0})),Object(u.a)(c,f.deleteContact.fulfilled,(function(){return!1})),Object(u.a)(c,f.deleteContact.rejected,(function(){return!1})),c)),p=Object(s.d)(null,(a={},Object(u.a)(a,f.fetchContacts.rejected,(function(t,e){return e.payload})),Object(u.a)(a,f.fetchContacts.pending,(function(){return null})),Object(u.a)(a,f.addContact.rejected,(function(t,e){return e.payload})),Object(u.a)(a,f.addContact.fulfilled,(function(){return null})),Object(u.a)(a,f.deleteContact.rejected,(function(t,e){return e.payload})),Object(u.a)(a,f.deleteContact.fulfilled,(function(){return null})),a)),j=Object(s.d)("",Object(u.a)({},l.a.filterContacts,(function(t,e){return e.payload})));e.a=Object(i.b)({entities:d,isLoading:b,error:p,filter:j})},58:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return i}));var r={};n.r(r),n.d(r,"filterContacts",(function(){return u}));var c={};n.r(c),n.d(c,"getContacts",(function(){return o})),n.d(c,"getToken",(function(){return s}));var a=n(8),u=Object(a.b)("filter"),o=function(t){return t.contacts.entities},s=function(t){return t.auth.token},i=n(9);n(45)},72:function(t,e,n){t.exports={main:"App_main__2fEr6",title:"App_title__QajOg",Container:"App_Container__b4CU4"}},9:function(t,e,n){"use strict";n.r(e),n.d(e,"fetchContacts",(function(){return h})),n.d(e,"addContact",(function(){return O})),n.d(e,"deleteContact",(function(){return g}));var r=n(18),c=n(7),a=n.n(c),u=n(8),o=n(33),s=n(19),i=n.n(s);function l(t){return f.apply(this,arguments)}function f(){return(f=Object(r.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.get("/contacts",e);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(t){return b.apply(this,arguments)}function b(){return(b=Object(r.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.post("/contacts/contacts",e);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(t){return j.apply(this,arguments)}function j(){return(j=Object(r.a)(a.a.mark((function t(e){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.delete("/contacts/".concat(e));case 2:return n=t.sent,r=n.data,t.abrupt("return",Object(o.a)(Object(o.a)({},r),{},{contactId:e}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}i.a.defaults.baseURL="https://61efe336732d93001778e67c.mockapi.io";var h=Object(u.c)("fetchContactsSuccess",function(){var t=Object(r.a)(a.a.mark((function t(e,n){var r,c,u;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.rejectWithValue,t.prev=1,e){t.next=4;break}return t.abrupt("return");case 4:return c={headers:{Authorization:"Bearer ".concat(e)}},t.next=7,l(c);case 7:return u=t.sent,t.abrupt("return",u);case 11:return t.prev=11,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()),O=Object(u.c)("contacts/addContact",function(){var t=Object(r.a)(a.a.mark((function t(e,n){var r,c,u,o,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,c=e.number,u=n.rejectWithValue,t.prev=2,o={name:r,number:c},t.next=6,d(o);case 6:return s=t.sent,t.abrupt("return",s);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",u(t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n){return t.apply(this,arguments)}}()),g=Object(u.c)("contacts/deleteContact",function(){var t=Object(r.a)(a.a.mark((function t(e,n){var r,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.rejectWithValue,t.prev=1,t.next=4,p(e);case 4:return c=t.sent,t.abrupt("return",c);case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}},[[108,2,3]]]);
//# sourceMappingURL=main.ae9c5683.chunk.js.map